<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>asr.grammar documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Asr</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Introduction to asr</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>asr</span></div></div></li><li class="depth-2 branch"><a href="asr.arithmetic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>arithmetic</span></div></a></li><li class="depth-2 branch"><a href="asr.asr.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>asr</span></div></a></li><li class="depth-2 branch"><a href="asr.autospecs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>autospecs</span></div></a></li><li class="depth-2 branch"><a href="asr.base-specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>base-specs</span></div></a></li><li class="depth-2 branch"><a href="asr.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="asr.data.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>expr</span></div></div></li><li class="depth-3 branch"><a href="asr.expr.semnasr.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>semnasr</span></div></a></li><li class="depth-3 branch"><a href="asr.expr.semsem.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>semsem</span></div></a></li><li class="depth-3"><a href="asr.expr.synnasr.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>synnasr</span></div></a></li><li class="depth-2 branch current"><a href="asr.grammar.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>grammar</span></div></a></li><li class="depth-2 branch"><a href="asr.numbers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>numbers</span></div></a></li><li class="depth-2 branch"><a href="asr.parsed.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parsed</span></div></a></li><li class="depth-2 branch"><a href="asr.sandbox.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sandbox</span></div></a></li><li class="depth-2 branch"><a href="asr.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-2 branch"><a href="asr.stats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stats</span></div></a></li><li class="depth-2"><a href="asr.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="asr.grammar.html#var-asdl-grammar"><div class="inner"><span>asdl-grammar</span></div></a></li><li class="depth-1"><a href="asr.grammar.html#var-asdl-parser"><div class="inner"><span>asdl-parser</span></div></a></li><li class="depth-1"><a href="asr.grammar.html#var-asr-pre-spec"><div class="inner"><span>asr-pre-spec</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">asr.grammar</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-asdl-grammar"><h3>asdl-grammar</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>We’ll parse the ASDL spec for ASR into Clojure vectors and hashmaps, then generate clojure.specs for terms and forms from the vectors and hashmaps.</p>
<p>The only thing less-than-obvious in the following grammar are angle brackets. They mean “don’t bother reporting this term.” Cuts down on clutter in the output.</p>
<p>The grammar says:</p>
<ol>
<li>
<p>An ASDL spec is a bunch of <strong><em>productions</em></strong> or ASDL-DEFs</p>
</li>
<li>
<p>An ASDL-DEF, aka <strong><em>speclet</em></strong>, is a triple of (a) <strong><em>term</em></strong> or ASDL-TERM, (b) an equals sign, and (c) one or more ASDL-FORMs separated by vertical bar characters. The meaning of an ASDL-DEF is an <em>alternation</em>, a list of alternative ASDL-FORMs.</p>
</li>
</ol>
<p>There are about 28 terms. See all-terms-test in core_test.clj. They are things like ::array_index, ::ttype, ::expr, etc.</p>
<ol>
<li>
<p>There are three <em>kinds</em> of ASDL-FORM or speclet: a <strong><em>composite</em></strong>, a <strong><em>symconst</em></strong>, or a <strong><em>tuple</em></strong>.</p>
</li>
<li>
<p>A <em>composite</em> is a ASDL-HEAD <strong><em>head</em></strong> followed by ASDL-ARGSs args. Args are identical in shape to a tuple.</p>
</li>
</ol>
<p>There are about 227 heads, about six of which are asr-tuples with gensymmed names. They are things like ::GetPointer, ::FileClose, ::TypeParameter, etc. See all-heads-test in core_test.clj.</p>
<ol>
<li>
<p>A <em>symconst</em> is just an identifier, reckoned as the <em>head</em> of the symconst.</p>
</li>
<li>
<p>A tuple is a comma-separated list (in round brackets) of pairs of <strong><em>type</em></strong> and <strong><em>variable</em></strong>.</p>
</li>
</ol>
<p>A tuple is anonymous, but we gensym a <em>head</em> for them, so that every kind of ASDL-FORM has a head, for convenience.</p>
<ol>
<li>Types can have <em>quantitative qualifiers</em>, aka <em>multiplicities</em>: STAR or QUES, meaning that the variable denotes “zero or more” and “at least one” instance of the type respectively. The default quantity is “exactly once.”</li>
</ol>
<p>The big picture to remember about <em>terms</em> and <em>heads</em> is that a <em>speclet</em> looks like one of the following three:</p>
<ol>
<li>
<p><code>term</code> <code>=</code> <code>composite-</code><em><code>head</code></em><code>-1</code> <code>args</code> <code>|</code> <code>composite-</code><em><code>head</code></em><code>-2</code> <code>args</code> <code>|</code> …</p>
</li>
<li>
<p><code>term</code> <code>=</code> <code>symconst-</code><em><code>head</code></em> <code>|</code> <code>symconst-</code><em><code>head</code></em> <code>|</code> …</p>
</li>
<li>
<p><code>term</code> <code>=</code> <code>tuple</code> (anonymous gensymmed <em>head</em>)</p>
</li>
</ol>
<p>A <em>term</em> corresponds to one or more (a <em>bunch</em> of) <em>heads</em>, but each head corresponds to exactly one term.</p>
<p>A term has exactly one <em>speclet</em>. The speclet is the whole line, left-hand side (term) and right-hand side (bunch of <em>forms</em>, one per head).</p>
<p>All forms in a speclet have the same kind: composite, symconst, or tuple. There won’t be a mixture of composites and symconsts, for instance, on the right-hand side of any term.</p>
<p>In addition to the 3 kinds, it turns out there are about 28 terms and speclets, and 227 heads, forms, and clojure.specs when we’re done. The number grows slowly as we add features to ASR.</p>
</div></div></div><div class="public anchor" id="var-asdl-parser"><h3>asdl-parser</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-asr-pre-spec"><h3>asr-pre-spec</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Capture the parse of ASR.asdl into hiccup format <strong>(</strong><a href="https://github.com/weavejester/hiccup">https://github.com/weavejester/hiccup</a><strong>).</strong></p>
</div></div></div></div></body></html>